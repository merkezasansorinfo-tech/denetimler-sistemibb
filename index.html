<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Merkez Asansör - Profesyonel Bakım Yönetim Sistemi</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #1e40af;
            --primary-light: #3b82f6;
            --success: #059669;
            --warning: #d97706;
            --danger: #dc2626;
            --info: #0891b2;
            --dark: #0f172a;
            --gray: #64748b;
            --light: #f8fafc;
            --border: #e2e8f0;
        }

        body {
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
            background: #f1f5f9;
            min-height: 100vh;
            color: var(--dark);
        }

        /* Top Navigation */
        .top-header {
            background: linear-gradient(135deg, var(--primary) 0%, #1e3a8a 100%);
            color: white;
            padding: 0 30px;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            box-shadow: 0 4px 20px rgba(0,0,0,0.2);
        }

        .header-container {
            max-width: 1600px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: space-between;
            height: 70px;
        }

        .brand {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .brand-icon {
            width: 45px;
            height: 45px;
            background: rgba(255,255,255,0.2);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            backdrop-filter: blur(10px);
        }

        .brand-text h1 {
            font-size: 22px;
            font-weight: 700;
            letter-spacing: -0.5px;
        }

        .brand-text span {
            font-size: 12px;
            opacity: 0.9;
            display: block;
            margin-top: -2px;
        }

        /* Navigation Tabs */
        .main-nav {
            display: flex;
            gap: 5px;
            background: rgba(255,255,255,0.1);
            padding: 5px;
            border-radius: 12px;
            backdrop-filter: blur(10px);
        }

        .nav-item {
            position: relative;
        }

        .nav-item a {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px 20px;
            color: rgba(255,255,255,0.8);
            text-decoration: none;
            border-radius: 8px;
            transition: all 0.3s;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
        }

        .nav-item a:hover {
            background: rgba(255,255,255,0.15);
            color: white;
        }

        .nav-item a.active {
            background: white;
            color: var(--primary);
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .nav-item a i {
            font-size: 16px;
        }

        /* Header Actions */
        .header-actions {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .emergency-btn {
            background: var(--danger);
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            font-size: 13px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            animation: pulse 2s infinite;
            cursor: pointer;
            border: none;
        }

        @keyframes pulse {
            0%, 100% { box-shadow: 0 0 0 0 rgba(220, 38, 38, 0.4); }
            50% { box-shadow: 0 0 0 10px rgba(220, 38, 38, 0); }
        }

        .notification-bell {
            position: relative;
            cursor: pointer;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            background: rgba(255,255,255,0.1);
            transition: all 0.3s;
        }

        .notification-bell:hover {
            background: rgba(255,255,255,0.2);
        }

        .notification-bell i {
            font-size: 20px;
        }

        .notif-badge {
            position: absolute;
            top: -2px;
            right: -2px;
            background: var(--danger);
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 11px;
            font-weight: bold;
            border: 2px solid var(--primary);
        }

        .user-menu {
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            padding: 5px 15px 5px 5px;
            border-radius: 25px;
            background: rgba(255,255,255,0.1);
            transition: all 0.3s;
        }

        .user-menu:hover {
            background: rgba(255,255,255,0.2);
        }

        .user-avatar {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            background: linear-gradient(135deg, #fbbf24, #f59e0b);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: white;
            font-size: 14px;
        }

        .user-info {
            line-height: 1.2;
        }

        .user-name {
            font-size: 14px;
            font-weight: 600;
        }

        .user-role {
            font-size: 11px;
            opacity: 0.8;
        }

        /* Sub Navigation */
        .sub-nav {
            background: white;
            border-bottom: 1px solid var(--border);
            padding: 0 30px;
            position: fixed;
            top: 70px;
            left: 0;
            right: 0;
            z-index: 999;
        }

        .sub-nav-container {
            max-width: 1600px;
            margin: 0 auto;
            display: flex;
            gap: 30px;
            height: 50px;
            align-items: center;
        }

        .breadcrumb {
            display: flex;
            align-items: center;
            gap: 10px;
            color: var(--gray);
            font-size: 14px;
        }

        .breadcrumb i {
            font-size: 12px;
        }

        .quick-actions {
            display: flex;
            gap: 10px;
            margin-left: auto;
        }

        .btn-quick {
            padding: 8px 16px;
            border: 1px solid var(--border);
            background: white;
            border-radius: 8px;
            font-size: 13px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 6px;
            transition: all 0.3s;
            color: var(--dark);
        }

        .btn-quick:hover {
            background: var(--light);
            border-color: var(--primary);
            color: var(--primary);
        }

        /* Main Content */
        .main-wrapper {
            margin-top: 120px;
            padding: 30px;
            max-width: 1600px;
            margin-left: auto;
            margin-right: auto;
        }

        .page-title {
            margin-bottom: 25px;
        }

        .page-title h2 {
            font-size: 28px;
            color: var(--dark);
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .page-title p {
            color: var(--gray);
            margin-top: 5px;
            font-size: 15px;
        }

        /* Stats Cards */
        .stats-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            border-radius: 16px;
            padding: 24px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            border: 1px solid var(--border);
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }

        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
        }

        .stat-card.blue::before { background: var(--primary); }
        .stat-card.green::before { background: var(--success); }
        .stat-card.orange::before { background: var(--warning); }
        .stat-card.red::before { background: var(--danger); }

        .stat-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 15px;
        }

        .stat-icon-box {
            width: 48px;
            height: 48px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }

        .stat-card.blue .stat-icon-box { background: #dbeafe; color: var(--primary); }
        .stat-card.green .stat-icon-box { background: #d1fae5; color: var(--success); }
        .stat-card.orange .stat-icon-box { background: #fef3c7; color: var(--warning); }
        .stat-card.red .stat-icon-box { background: #fee2e2; color: var(--danger); }

        .stat-trend {
            font-size: 12px;
            padding: 4px 8px;
            border-radius: 20px;
            font-weight: 600;
        }

        .trend-up { background: #d1fae5; color: var(--success); }
        .trend-down { background: #fee2e2; color: var(--danger); }

        .stat-value {
            font-size: 32px;
            font-weight: 700;
            color: var(--dark);
            margin-bottom: 4px;
        }

        .stat-label {
            color: var(--gray);
            font-size: 14px;
        }

        .stat-footer {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 13px;
            color: var(--gray);
        }

        /* Content Grid */
        .content-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 25px;
            margin-bottom: 25px;
        }

        .content-grid.full {
            grid-template-columns: 1fr;
        }

        /* Cards */
        .card {
            background: white;
            border-radius: 16px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            border: 1px solid var(--border);
            overflow: hidden;
        }

        .card-header {
            padding: 20px 24px;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .card-title {
            font-size: 18px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .card-title i {
            color: var(--primary);
        }

        .card-tools {
            display: flex;
            gap: 10px;
        }

        .card-body {
            padding: 24px;
        }

        /* Buttons */
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            font-size: 14px;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background: #1e3a8a;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(30, 64, 175, 0.3);
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .btn-warning {
            background: var(--warning);
            color: white;
        }

        .btn-danger {
            background: var(--danger);
            color: white;
        }

        .btn-outline {
            background: white;
            border: 1px solid var(--border);
            color: var(--dark);
        }

        .btn-outline:hover {
            border-color: var(--primary);
            color: var(--primary);
        }

        .btn-sm {
            padding: 6px 12px;
            font-size: 13px;
        }

        /* Tables */
        .table-responsive {
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th {
            background: #f8fafc;
            padding: 14px 16px;
            text-align: left;
            font-size: 12px;
            font-weight: 600;
            color: var(--gray);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            border-bottom: 1px solid var(--border);
        }

        td {
            padding: 16px;
            border-bottom: 1px solid var(--border);
            font-size: 14px;
        }

        tr:hover {
            background: #f8fafc;
        }

        .cell-main {
            font-weight: 600;
            color: var(--dark);
        }

        .cell-sub {
            font-size: 12px;
            color: var(--gray);
            margin-top: 2px;
        }

        /* Status Badges */
        .badge {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 5px;
        }

        .badge::before {
            content: '';
            width: 6px;
            height: 6px;
            border-radius: 50%;
        }

        .badge-success {
            background: #d1fae5;
            color: #065f46;
        }

        .badge-success::before { background: var(--success); }

        .badge-warning {
            background: #fef3c7;
            color: #92400e;
        }

        .badge-warning::before { background: var(--warning); }

        .badge-danger {
            background: #fee2e2;
            color: #991b1b;
        }

        .badge-danger::before { background: var(--danger); }

        .badge-info {
            background: #cffafe;
            color: #155e75;
        }

        .badge-info::before { background: var(--info); }

        /* Alerts */
        .alert {
            padding: 16px 20px;
            border-radius: 12px;
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 14px;
        }

        .alert-danger {
            background: #fee2e2;
            border: 1px solid #fecaca;
            color: #991b1b;
        }

        .alert-warning {
            background: #fef3c7;
            border: 1px solid #fde68a;
            color: #92400e;
        }

        /* Map */
        .map-container {
            height: 500px;
            border-radius: 12px;
            overflow: hidden;
            position: relative;
        }

        #map, #locationMap {
            height: 100%;
            width: 100%;
        }

        .map-controls {
            position: absolute;
            top: 15px;
            right: 15px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            padding: 10px;
            display: flex;
            flex-direction: column;
            gap: 5px;
            z-index: 1000;
        }

        .map-btn {
            width: 36px;
            height: 36px;
            border: none;
            background: white;
            border-radius: 6px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--gray);
            transition: all 0.3s;
        }

        .map-btn:hover {
            background: var(--light);
            color: var(--primary);
        }

        .map-legend {
            position: absolute;
            bottom: 15px;
            left: 15px;
            background: white;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            z-index: 1000;
        }

        /* Form Builder */
        .builder-layout {
            display: grid;
            grid-template-columns: 280px 1fr;
            gap: 25px;
        }

        .tools-panel {
            background: white;
            border-radius: 16px;
            padding: 20px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            border: 1px solid var(--border);
            height: fit-content;
        }

        .tool-category {
            margin-bottom: 20px;
        }

        .tool-category h4 {
            font-size: 12px;
            text-transform: uppercase;
            color: var(--gray);
            margin-bottom: 12px;
            letter-spacing: 0.5px;
        }

        .tool-item {
            padding: 12px;
            margin-bottom: 8px;
            background: #f8fafc;
            border: 2px solid transparent;
            border-radius: 10px;
            cursor: move;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 14px;
        }

        .tool-item:hover {
            border-color: var(--primary);
            background: #eff6ff;
        }

        .tool-item i {
            color: var(--primary);
            width: 20px;
        }

        .canvas-area {
            background: white;
            border-radius: 16px;
            padding: 30px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            border: 1px solid var(--border);
            min-height: 600px;
        }

        .form-element {
            padding: 20px;
            border: 1px solid var(--border);
            border-radius: 10px;
            margin-bottom: 15px;
            position: relative;
            background: #fafafa;
            transition: all 0.3s;
        }

        .form-element:hover {
            border-color: var(--primary);
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
        }

        .element-actions {
            position: absolute;
            top: 10px;
            right: 10px;
            display: none;
            gap: 5px;
        }

        .form-element:hover .element-actions {
            display: flex;
        }

        .action-btn {
            width: 28px;
            height: 28px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
        }

        /* Calendar */
        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .calendar-nav {
            display: flex;
            gap: 10px;
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 8px;
        }

        .calendar-day-header {
            text-align: center;
            padding: 10px;
            font-size: 12px;
            font-weight: 600;
            color: var(--gray);
            text-transform: uppercase;
        }

        .calendar-day {
            aspect-ratio: 1;
            background: #f8fafc;
            border-radius: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            border: 2px solid transparent;
        }

        .calendar-day:hover {
            background: #e0e7ff;
            border-color: var(--primary);
        }

        .calendar-day.active {
            background: var(--primary);
            color: white;
        }

        .calendar-day.has-event::after {
            content: '';
            position: absolute;
            bottom: 6px;
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: var(--danger);
        }

        .day-number {
            font-weight: 600;
            font-size: 16px;
        }

        .day-events {
            position: absolute;
            top: 4px;
            right: 4px;
            width: 8px;
            height: 8px;
            border-radius: 50%;
        }

        /* Modal */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 2000;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(4px);
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal-container {
            background: white;
            border-radius: 20px;
            width: 90%;
            max-width: 600px;
            max-height: 90vh;
            overflow: hidden;
            animation: modalSlide 0.3s;
        }

        @keyframes modalSlide {
            from { transform: translateY(-30px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .modal-header {
            padding: 24px;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-title {
            font-size: 20px;
            font-weight: 600;
        }

        .modal-close {
            width: 36px;
            height: 36px;
            border: none;
            background: #f1f5f9;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }

        .modal-close:hover {
            background: #e2e8f0;
        }

        .modal-body {
            padding: 24px;
            overflow-y: auto;
            max-height: 60vh;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            font-size: 14px;
            color: var(--dark);
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--border);
            border-radius: 10px;
            font-size: 14px;
            transition: all 0.3s;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(30, 64, 175, 0.1);
        }

        .modal-footer {
            padding: 20px 24px;
            border-top: 1px solid var(--border);
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }

        /* Charts */
        .chart-container {
            position: relative;
            height: 300px;
        }

        /* Activity Feed */
        .activity-item {
            display: flex;
            gap: 15px;
            padding: 16px 0;
            border-bottom: 1px solid var(--border);
        }

        .activity-item:last-child {
            border-bottom: none;
        }

        .activity-icon {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .activity-icon.maintenance { background: #dbeafe; color: var(--primary); }
        .activity-icon.inspection { background: #d1fae5; color: var(--success); }
        .activity-icon.alert { background: #fee2e2; color: var(--danger); }

        .activity-content {
            flex: 1;
        }

        .activity-title {
            font-weight: 600;
            margin-bottom: 4px;
        }

        .activity-desc {
            font-size: 13px;
            color: var(--gray);
            margin-bottom: 4px;
        }

        .activity-time {
            font-size: 12px;
            color: #94a3b8;
        }

        /* Search and Filter */
        .search-filter {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
        }

        .search-box {
            position: relative;
            flex: 1;
        }

        .search-box input {
            width: 100%;
            padding: 12px 16px 12px 45px;
            border: 1px solid var(--border);
            border-radius: 10px;
            font-size: 14px;
            transition: all 0.3s;
        }

        .search-box input:focus {
            outline: none;
            border-color: var(--primary);
        }

        .search-box i {
            position: absolute;
            left: 16px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--gray);
        }

        .filter-select {
            padding: 12px 40px 12px 16px;
            border: 1px solid var(--border);
            border-radius: 10px;
            font-size: 14px;
            background: white;
            cursor: pointer;
            min-width: 150px;
        }

        /* Location Selector in Map */
        .location-selector {
            position: absolute;
            top: 15px;
            left: 15px;
            background: white;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            z-index: 1000;
            max-width: 300px;
        }

        .location-info {
            margin-top: 10px;
            padding: 10px;
            background: #f8fafc;
            border-radius: 8px;
            font-size: 13px;
        }

        .location-coordinates {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }

        .location-coordinates input {
            flex: 1;
            padding: 8px;
            border: 1px solid var(--border);
            border-radius: 6px;
            font-size: 12px;
        }

        /* Responsive */
        @media (max-width: 1200px) {
            .content-grid {
                grid-template-columns: 1fr;
            }
            
            .builder-layout {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .main-nav {
                display: none;
            }
            
            .header-container {
                flex-wrap: wrap;
            }
            
            .stats-row {
                grid-template-columns: 1fr;
            }
            
            .location-selector {
                max-width: 200px;
            }
        }

        /* Animations */
        .fade-in {
            animation: fadeIn 0.5s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Loading */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: var(--gray);
        }

        .empty-state i {
            font-size: 64px;
            margin-bottom: 20px;
            opacity: 0.3;
        }

        .empty-state h3 {
            margin-bottom: 10px;
            color: var(--dark);
        }

        /* Section Display */
        .section-content {
            display: none;
        }

        .section-content.active {
            display: block;
            animation: fadeIn 0.4s;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #f1f5f9;
        }

        ::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }

        /* Progress Bar */
        .progress-bar {
            height: 8px;
            background: #e2e8f0;
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            border-radius: 4px;
            background: var(--primary);
            transition: width 0.3s;
        }
    </style>
</head>
<body>
    <!-- Top Header -->
    <header class="top-header">
        <div class="header-container">
            <div class="brand">
                <div class="brand-icon">
                    <i class="fas fa-elevator"></i>
                </div>
                <div class="brand-text">
                    <h1>MERKEZ ASANSÖR</h1>
                    <span>Bakım Yönetim Sistemi</span>
                </div>
            </div>

            <nav class="main-nav">
                <div class="nav-item">
                    <a class="active" onclick="showSection('map', this)">
                        <i class="fas fa-map-marked-alt"></i>
                        <span>Harita</span>
                    </a>
                </div>
                <div class="nav-item">
                    <a onclick="showSection('buildings', this)">
                        <i class="fas fa-building"></i>
                        <span>Binalar</span>
                    </a>
                </div>
                <div class="nav-item">
                    <a onclick="showSection('maintenance', this)">
                        <i class="fas fa-tools"></i>
                        <span>Bakım</span>
                    </a>
                </div>
                <div class="nav-item">
                    <a onclick="showSection('inspections', this)">
                        <i class="fas fa-clipboard-check"></i>
                        <span>Denetim</span>
                    </a>
                </div>
                <div class="nav-item">
                    <a onclick="showSection('forms', this)">
                        <i class="fas fa-file-signature"></i>
                        <span>Formlar</span>
                    </a>
                </div>
                <div class="nav-item">
                    <a onclick="showSection('accounting', this)">
                        <i class="fas fa-chart-line"></i>
                        <span>Muhasebe</span>
                    </a>
                </div>
                <div class="nav-item">
                    <a onclick="showSection('calendar', this)">
                        <i class="fas fa-calendar-alt"></i>
                        <span>Takvim</span>
                    </a>
                </div>
            </nav>

            <div class="header-actions">
                <button class="emergency-btn" onclick="makeEmergencyCall()">
                    <i class="fas fa-phone-alt"></i>
                    <span>Acil Destek</span>
                </button>
                
                <div class="notification-bell" onclick="showNotifications()">
                    <i class="fas fa-bell"></i>
                    <span class="notif-badge" id="notifCount">5</span>
                </div>

                <div class="user-menu" onclick="toggleUserMenu()">
                    <div class="user-avatar">AY</div>
                    <div class="user-info">
                        <div class="user-name">Ahmet Yılmaz</div>
                        <div class="user-role">Yönetici</div>
                    </div>
                    <i class="fas fa-chevron-down" style="margin-left: 5px; font-size: 12px;"></i>
                </div>
            </div>
        </div>
    </header>

    <!-- Sub Navigation -->
    <div class="sub-nav">
        <div class="sub-nav-container">
            <div class="breadcrumb">
                <i class="fas fa-home"></i>
                <span>Ana Sayfa</span>
                <i class="fas fa-chevron-right"></i>
                <span id="breadcrumbText">Harita</span>
            </div>
            
            <div class="quick-actions">
                <button class="btn-quick" onclick="openModal('quickMaintenanceModal')">
                    <i class="fas fa-plus"></i> Hızlı Bakım
                </button>
                <button class="btn-quick" onclick="openModal('quickReportModal')">
                    <i class="fas fa-file-export"></i> Rapor Al
                </button>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <main class="main-wrapper">
        
        <!-- MAP SECTION (FIRST PAGE) -->
        <section id="map" class="section-content active">
            <div class="page-title">
                <h2><i class="fas fa-map-marked-alt"></i> Harita Görünümü</h2>
                <p>Tüm binaların konumları ve bakım durumları</p>
            </div>

            <div class="alert alert-warning">
                <i class="fas fa-exclamation-circle"></i>
                <div>
                    <strong>3 asansör bakımı gecikmiş durumda!</strong> Merkez Plaza, İş Kulesi ve Residence Towers için acil bakım planlaması yapılması gerekiyor.
                </div>
            </div>

            <div class="card">
                <div class="card-body" style="padding: 0;">
                    <div class="map-container">
                        <div id="map"></div>
                        <div class="map-controls">
                            <button class="map-btn" onclick="map.zoomIn()" title="Yakınlaştır"><i class="fas fa-plus"></i></button>
                            <button class="map-btn" onclick="map.zoomOut()" title="Uzaklaştır"><i class="fas fa-minus"></i></button>
                            <button class="map-btn" onclick="resetMap()" title="Sıfırla"><i class="fas fa-compress-arrows-alt"></i></button>
                            <button class="map-btn" onclick="locateMe()" title="Konumumu Bul"><i class="fas fa-location-arrow"></i></button>
                        </div>
                        <div class="map-legend">
                            <div style="font-weight: 600; margin-bottom: 10px;">Durum Göstergesi</div>
                            <div class="legend-item" style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                                <div style="width: 12px; height: 12px; border-radius: 50%; background: var(--success);"></div>
                                <span style="font-size: 13px;">Bakım Tamamlandı</span>
                            </div>
                            <div class="legend-item" style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                                <div style="width: 12px; height: 12px; border-radius: 50%; background: var(--warning);"></div>
                                <span style="font-size: 13px;">Bakım Yaklaşıyor</span>
                            </div>
                            <div class="legend-item" style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                                <div style="width: 12px; height: 12px; border-radius: 50%; background: var(--danger);"></div>
                                <span style="font-size: 13px;">Acil Bakım Gerekli</span>
                            </div>
                            <div class="legend-item" style="display: flex; align-items: center; gap: 8px;">
                                <div style="width: 12px; height: 12px; border-radius: 50%; background: var(--primary);"></div>
                                <span style="font-size: 13px;">Planlandı</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="content-grid" style="margin-top: 25px;">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-list"></i>
                            Yakındaki Binalar
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="activity-item" style="padding: 12px 0;">
                            <div class="activity-icon" style="background: #fee2e2; color: var(--danger);">
                                <i class="fas fa-building"></i>
                            </div>
                            <div class="activity-content">
                                <div class="activity-title">Merkez Plaza</div>
                                <div class="activity-desc">0.5 km - Bakım gecikmiş</div>
                            </div>
                            <button class="btn btn-primary btn-sm" onclick="navigateToBuilding('Merkez Plaza')">Git</button>
                        </div>
                        <div class="activity-item" style="padding: 12px 0;">
                            <div class="activity-icon" style="background: #fef3c7; color: var(--warning);">
                                <i class="fas fa-building"></i>
                            </div>
                            <div class="activity-content">
                                <div class="activity-title">İş Kulesi</div>
                                <div class="activity-desc">1.2 km - Bakım yaklaşıyor</div>
                            </div>
                            <button class="btn btn-primary btn-sm" onclick="navigateToBuilding('İş Kulesi')">Git</button>
                        </div>
                        <div class="activity-item" style="padding: 12px 0; border-bottom: none;">
                            <div class="activity-icon" style="background: #dbeafe; color: var(--primary);">
                                <i class="fas fa-building"></i>
                            </div>
                            <div class="activity-content">
                                <div class="activity-title">Residence Towers</div>
                                <div class="activity-desc">2.1 km - Planlandı</div>
                            </div>
                            <button class="btn btn-primary btn-sm" onclick="navigateToBuilding('Residence Towers')">Git</button>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-route"></i>
                            Rota Planlama
                        </div>
                    </div>
                    <div class="card-body">
                        <p style="color: var(--gray); margin-bottom: 15px;">Bugün için optimize edilmiş rota:</p>
                        <div style="background: #f8fafc; padding: 15px; border-radius: 10px; margin-bottom: 15px;">
                            <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                                <div style="width: 24px; height: 24px; background: var(--danger); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 12px; font-weight: bold;">1</div>
                                <span>Merkez Plaza (Acil)</span>
                            </div>
                            <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                                <div style="width: 24px; height: 24px; background: var(--warning); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 12px; font-weight: bold;">2</div>
                                <span>İş Kulesi</span>
                            </div>
                            <div style="display: flex; align-items: center; gap: 10px;">
                                <div style="width: 24px; height: 24px; background: var(--primary); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 12px; font-weight: bold;">3</div>
                                <span>Residence Towers</span>
                            </div>
                        </div>
                        <button class="btn btn-primary" style="width: 100%;" onclick="startNavigation()">
                            <i class="fas fa-location-arrow"></i> Rotayı Başlat
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <!-- BUILDINGS SECTION -->
        <section id="buildings" class="section-content">
            <div class="page-title">
                <h2><i class="fas fa-building"></i> Bina Yönetimi</h2>
                <p>Tüm binalar ve asansör bilgileri</p>
            </div>

            <div class="search-filter">
                <div class="search-box">
                    <i class="fas fa-search"></i>
                    <input type="text" id="buildingSearch" placeholder="Bina ara..." onkeyup="filterBuildings()">
                </div>
                <select class="filter-select" id="districtFilter" onchange="filterBuildings()">
                    <option value="">Tüm İlçeler</option>
                    <option value="sisli">Şişli</option>
                    <option value="besiktas">Beşiktaş</option>
                    <option value="kadikoy">Kadıköy</option>
                </select>
                <select class="filter-select" id="statusFilter" onchange="filterBuildings()">
                    <option value="">Tüm Durumlar</option>
                    <option value="active">Aktif</option>
                    <option value="maintenance">Bakımda</option>
                    <option value="inactive">Pasif</option>
                </select>
                <button class="btn btn-primary" onclick="openBuildingModal()">
                    <i class="fas fa-plus"></i> Yeni Bina Ekle
                </button>
            </div>

            <div class="card">
                <div class="card-body" style="padding: 0;">
                    <div class="table-responsive">
                        <table id="buildingsTable">
                            <thead>
                                <tr>
                                    <th>Bina Kodu</th>
                                    <th>Bina Adı</th>
                                    <th>Adres</th>
                                    <th>Asansör</th>
                                    <th>Sorumlu</th>
                                    <th>Durum</th>
                                    <th>İşlemler</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr data-district="sisli" data-status="active">
                                    <td><strong>BIN-2024-001</strong></td>
                                    <td>Merkez Plaza</td>
                                    <td>Şişli, İstanbul<br><small>Atatürk Cad. No:123</small></td>
                                    <td>4 adet</td>
                                    <td>Mehmet Kaya</td>
                                    <td><span class="badge badge-success">Aktif</span></td>
                                    <td>
                                        <button class="btn btn-outline btn-sm" onclick="viewBuilding('BIN-2024-001')"><i class="fas fa-eye"></i></button>
                                        <button class="btn btn-primary btn-sm" onclick="editBuilding('BIN-2024-001')"><i class="fas fa-edit"></i></button>
                                        <button class="btn btn-danger btn-sm" onclick="deleteBuilding('BIN-2024-001')"><i class="fas fa-trash"></i></button>
                                    </td>
                                </tr>
                                <tr data-district="sisli" data-status="maintenance">
                                    <td><strong>BIN-2024-002</strong></td>
                                    <td>İş Kulesi</td>
                                    <td>Şişli, İstanbul<br><small>Levent Mah. No:45</small></td>
                                    <td>6 adet</td>
                                    <td>Ayşe Demir</td>
                                    <td><span class="badge badge-warning">Bakımda</span></td>
                                    <td>
                                        <button class="btn btn-outline btn-sm" onclick="viewBuilding('BIN-2024-002')"><i class="fas fa-eye"></i></button>
                                        <button class="btn btn-primary btn-sm" onclick="editBuilding('BIN-2024-002')"><i class="fas fa-edit"></i></button>
                                        <button class="btn btn-danger btn-sm" onclick="deleteBuilding('BIN-2024-002')"><i class="fas fa-trash"></i></button>
                                    </td>
                                </tr>
                                <tr data-district="besiktas" data-status="active">
                                    <td><strong>BIN-2024-003</strong></td>
                                    <td>Residence Towers</td>
                                    <td>Beşiktaş, İstanbul<br><small>Barbaros Bulvarı No:89</small></td>
                                    <td>8 adet</td>
                                    <td>Ali Yıldız</td>
                                    <td><span class="badge badge-success">Aktif</span></td>
                                    <td>
                                        <button class="btn btn-outline btn-sm" onclick="viewBuilding('BIN-2024-003')"><i class="fas fa-eye"></i></button>
                                        <button class="btn btn-primary btn-sm" onclick="editBuilding('BIN-2024-003')"><i class="fas fa-edit"></i></button>
                                        <button class="btn btn-danger btn-sm" onclick="deleteBuilding('BIN-2024-003')"><i class="fas fa-trash"></i></button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>

        <!-- MAINTENANCE SECTION -->
        <section id="maintenance" class="section-content">
            <div class="page-title">
                <h2><i class="fas fa-tools"></i> Bakım Yönetimi</h2>
                <p>Bakım planlaması ve geçmiş kayıtları</p>
            </div>

            <div class="content-grid">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-calendar-check"></i>
                            Bakım Planlaması
                        </div>
                        <button class="btn btn-primary" onclick="openModal('maintenanceModal')">
                            <i class="fas fa-plus"></i> Yeni Plan
                        </button>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Tarih</th>
                                        <th>Bina / Asansör</th>
                                        <th>Tip</th>
                                        <th>Teknisyen</th>
                                        <th>Durum</th>
                                        <th>Rapor</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>25.01.2026</td>
                                        <td>
                                            <div class="cell-main">Merkez Plaza</div>
                                            <div class="cell-sub">ASV-001</div>
                                        </td>
                                        <td>Aylık Bakım</td>
                                        <td>Mehmet Kaya</td>
                                        <td><span class="badge badge-success">Tamamlandı</span></td>
                                        <td><button class="btn btn-outline btn-sm" onclick="viewReport('REP-001')"><i class="fas fa-file-pdf"></i></button></td>
                                    </tr>
                                    <tr>
                                        <td>24.01.2026</td>
                                        <td>
                                            <div class="cell-main">İş Kulesi</div>
                                            <div class="cell-sub">ASV-024</div>
                                        </td>
                                        <td>Arıza Onarımı</td>
                                        <td>Ayşe Demir</td>
                                        <td><span class="badge badge-success">Tamamlandı</span></td>
                                        <td><button class="btn btn-outline btn-sm" onclick="viewReport('REP-002')"><i class="fas fa-file-pdf"></i></button></td>
                                    </tr>
                                    <tr>
                                        <td>20.01.2026</td>
                                        <td>
                                            <div class="cell-main">Residence Towers</div>
                                            <div class="cell-sub">ASV-089</div>
                                        </td>
                                        <td>3 Aylık Bakım</td>
                                        <td>Ali Yıldız</td>
                                        <td><span class="badge badge-warning">Devam Ediyor</span></td>
                                        <td><button class="btn btn-outline btn-sm" disabled><i class="fas fa-clock"></i></button></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-users"></i>
                            Teknisyenler
                        </div>
                    </div>
                    <div class="card-body" style="padding: 0;">
                        <div class="activity-item" style="padding: 16px 24px;">
                            <div class="user-avatar" style="background: var(--primary);">MK</div>
                            <div style="flex: 1;">
                                <div style="font-weight: 600;">Mehmet Kaya</div>
                                <div style="font-size: 13px; color: var(--gray);">8 aktif görev</div>
                            </div>
                            <span class="badge badge-success">Müsait</span>
                        </div>
                        <div class="activity-item" style="padding: 16px 24px;">
                            <div class="user-avatar" style="background: var(--success);">AD</div>
                            <div style="flex: 1;">
                                <div style="font-weight: 600;">Ayşe Demir</div>
                                <div style="font-size: 13px; color: var(--gray);">5 aktif görev</div>
                            </div>
                            <span class="badge badge-warning">Görevde</span>
                        </div>
                        <div class="activity-item" style="padding: 16px 24px; border-bottom: none;">
                            <div class="user-avatar" style="background: var(--warning);">AY</div>
                            <div style="flex: 1;">
                                <div style="font-weight: 600;">Ali Yıldız</div>
                                <div style="font-size: 13px; color: var(--gray);">3 aktif görev</div>
                            </div>
                            <span class="badge badge-success">Müsait</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- INSPECTIONS SECTION -->
        <section id="inspections" class="section-content">
            <div class="page-title">
                <h2><i class="fas fa-clipboard-check"></i> Denetim Yönetimi</h2>
                <p>Resmi denetimler ve yasal uyum takibi</p>
            </div>

            <div class="alert alert-warning">
                <i class="fas fa-info-circle"></i>
                <div>
                    <strong>2 denetim yaklaşıyor!</strong> Merkez Plaza yıllık kontrolü (15.02.2026) ve İş Kulesi periyodik kontrolü (20.02.2026) için hazırlık yapılması gerekiyor.
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <i class="fas fa-list-check"></i>
                        Denetim Listesi
                    </div>
                    <button class="btn btn-primary" onclick="openModal('inspectionModal')">
                        <i class="fas fa-plus"></i> Denetim Ekle
                    </button>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table>
                            <thead>
                                <tr>
                                    <th>Denetim Tarihi</th>
                                    <th>Bina</th>
                                    <th>Tip</th>
                                    <th>Yetkili Kurum</th>
                                    <th>Sonuç</th>
                                    <th>Sonraki</th>
                                    <th>Belge</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>15.12.2025</td>
                                    <td>Merkez Plaza</td>
                                    <td>Yıllık Kontrol</td>
                                    <td>İSGM</td>
                                    <td><span class="badge badge-success">Başarılı</span></td>
                                    <td>15.12.2026</td>
                                    <td><button class="btn btn-outline btn-sm" onclick="downloadDoc('DOC-001')"><i class="fas fa-download"></i></button></td>
                                </tr>
                                <tr>
                                    <td>20.01.2026</td>
                                    <td>İş Kulesi</td>
                                    <td>Periyodik Kontrol</td>
                                    <td>TSE</td>
                                    <td><span class="badge badge-warning">Düzeltme Gerekli</span></td>
                                    <td>20.07.2026</td>
                                    <td><button class="btn btn-outline btn-sm" onclick="downloadDoc('DOC-002')"><i class="fas fa-download"></i></button></td>
                                </tr>
                                <tr>
                                    <td>10.01.2026</td>
                                    <td>Residence Towers</td>
                                    <td>Ara Kontrol</td>
                                    <td>Belediye</td>
                                    <td><span class="badge badge-success">Başarılı</span></td>
                                    <td>10.07.2026</td>
                                    <td><button class="btn btn-outline btn-sm" onclick="downloadDoc('DOC-003')"><i class="fas fa-download"></i></button></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>

        <!-- FORMS SECTION -->
        <section id="forms" class="section-content">
            <div class="page-title">
                <h2><i class="fas fa-file-signature"></i> Form Oluşturucu</h2>
                <p>Özel formlar oluşturun ve yönetin</p>
            </div>

            <div class="builder-layout">
                <div class="tools-panel">
                    <div class="tool-category">
                        <h4>Temel Alanlar</h4>
                        <div class="tool-item" draggable="true" ondragstart="drag(event)" data-type="text">
                            <i class="fas fa-font"></i>
                            <span>Metin Alanı</span>
                        </div>
                        <div class="tool-item" draggable="true" ondragstart="drag(event)" data-type="number">
                            <i class="fas fa-hashtag"></i>
                            <span>Sayı Alanı</span>
                        </div>
                        <div class="tool-item" draggable="true" ondragstart="drag(event)" data-type="date">
                            <i class="fas fa-calendar"></i>
                            <span>Tarih</span>
                        </div>
                        <div class="tool-item" draggable="true" ondragstart="drag(event)" data-type="select">
                            <i class="fas fa-list"></i>
                            <span>Seçim Listesi</span>
                        </div>
                    </div>
                    
                    <div class="tool-category">
                        <h4>Gelişmiş Alanlar</h4>
                        <div class="tool-item" draggable="true" ondragstart="drag(event)" data-type="textarea">
                            <i class="fas fa-align-left"></i>
                            <span>Uzun Metin</span>
                        </div>
                        <div class="tool-item" draggable="true" ondragstart="drag(event)" data-type="checkbox">
                            <i class="fas fa-check-square"></i>
                            <span>Onay Kutusu</span>
                        </div>
                        <div class="tool-item" draggable="true" ondragstart="drag(event)" data-type="radio">
                            <i class="fas fa-dot-circle"></i>
                            <span>Seçenek Grubu</span>
                        </div>
                        <div class="tool-item" draggable="true" ondragstart="drag(event)" data-type="file">
                            <i class="fas fa-camera"></i>
                            <span>Fotoğraf Yükle</span>
                        </div>
                        <div class="tool-item" draggable="true" ondragstart="drag(event)" data-type="signature">
                            <i class="fas fa-signature"></i>
                            <span>İmza</span>
                        </div>
                    </div>

                    <div class="tool-category">
                        <h4>Hazır Şablonlar</h4>
                        <button class="btn btn-outline" style="width: 100%; margin-bottom: 8px;" onclick="loadTemplate('maintenance')">
                            <i class="fas fa-wrench"></i> Bakım Raporu
                        </button>
                        <button class="btn btn-outline" style="width: 100%; margin-bottom: 8px;" onclick="loadTemplate('inspection')">
                            <i class="fas fa-clipboard-check"></i> Denetim Formu
                        </button>
                        <button class="btn btn-outline" style="width: 100%;" onclick="loadTemplate('failure')">
                            <i class="fas fa-exclamation-triangle"></i> Arıza Formu
                        </button>
                    </div>
                </div>

                <div class="canvas-area" id="formCanvas" ondrop="drop(event)" ondragover="allowDrop(event)">
                    <div class="empty-state" id="formPlaceholder">
                        <i class="fas fa-mouse-pointer"></i>
                        <h3>Form Oluşturmaya Başlayın</h3>
                        <p>Sol taraftan form elemanlarını sürükleyip buraya bırakın<br>veya hazır şablonlardan birini seçin</p>
                    </div>
                </div>
            </div>

            <div style="margin-top: 20px; display: flex; gap: 10px; justify-content: flex-end;">
                <button class="btn btn-outline" onclick="clearForm()">
                    <i class="fas fa-trash"></i> Temizle
                </button>
                <button class="btn btn-primary" onclick="saveForm()">
                    <i class="fas fa-save"></i> Formu Kaydet
                </button>
                <button class="btn btn-success" onclick="previewForm()">
                    <i class="fas fa-eye"></i> Önizleme
                </button>
            </div>
        </section>

        <!-- ACCOUNTING SECTION -->
        <section id="accounting" class="section-content">
            <div class="page-title">
                <h2><i class="fas fa-chart-line"></i> Muhasebe & Finans</h2>
                <p>Gelir-gider takibi ve fatura yönetimi</p>
            </div>

            <div class="stats-row">
                <div class="stat-card green">
                    <div class="stat-header">
                        <div class="stat-icon-box">
                            <i class="fas fa-lira-sign"></i>
                        </div>
                    </div>
                    <div class="stat-value">₺125,450</div>
                    <div class="stat-label">Toplam Gelir (Ocak)</div>
                    <div class="stat-footer">
                        <span>Geçen ay: ₺118,200</span>
                        <span class="trend-up">+%6.1</span>
                    </div>
                </div>

                <div class="stat-card orange">
                    <div class="stat-header">
                        <div class="stat-icon-box">
                            <i class="fas fa-clock"></i>
                        </div>
                    </div>
                    <div class="stat-value">₺42,800</div>
                    <div class="stat-label">Bekleyen Ödeme</div>
                    <div class="stat-footer">
                        <span>12 fatura</span>
                        <span>Vadesi geçmiş: 3</span>
                    </div>
                </div>

                <div class="stat-card blue">
                    <div class="stat-header">
                        <div class="stat-icon-box">
                            <i class="fas fa-file-invoice"></i>
                        </div>
                    </div>
                    <div class="stat-value">156</div>
                    <div class="stat-label">Aktif Sözleşme</div>
                    <div class="stat-footer">
                        <span>Yenilenecek: 8</span>
                        <span>Bu ay</span>
                    </div>
                </div>

                <div class="stat-card red">
                    <div class="stat-header">
                        <div class="stat-icon-box">
                            <i class="fas fa-exclamation-circle"></i>
                        </div>
                    </div>
                    <div class="stat-value">₺18,500</div>
                    <div class="stat-label">Vadesi Geçmiş</div>
                    <div class="stat-footer">
                        <span>3 fatura</span>
                        <span>Tahsilat gerekli</span>
                    </div>
                </div>
            </div>

            <div class="content-grid">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-file-invoice-dollar"></i>
                            Fatura Listesi
                        </div>
                        <div class="card-tools">
                            <button class="btn btn-outline btn-sm" onclick="exportToExcel('invoicesTable')">
                                <i class="fas fa-file-excel"></i> Excel
                            </button>
                            <button class="btn btn-primary btn-sm" onclick="openModal('invoiceModal')">
                                <i class="fas fa-plus"></i> Yeni Fatura
                            </button>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="search-filter" style="margin-bottom: 20px;">
                            <div class="search-box" style="flex: 1;">
                                <i class="fas fa-search"></i>
                                <input type="text" id="invoiceSearch" placeholder="Fatura ara..." onkeyup="filterInvoices()">
                            </div>
                            <select class="filter-select" id="invoiceStatusFilter" onchange="filterInvoices()">
                                <option value="">Tüm Durumlar</option>
                                <option value="paid">Ödendi</option>
                                <option value="pending">Bekliyor</option>
                                <option value="overdue">Vadesi Geçti</option>
                            </select>
                        </div>
                        <div class="table-responsive">
                            <table id="invoicesTable">
                                <thead>
                                    <tr>
                                        <th>Fatura No</th>
                                        <th>Bina</th>
                                        <th>Dönem</th>
                                        <th>Tutar</th>
                                        <th>Durum</th>
                                        <th>Ödeme Tarihi</th>
                                        <th>İşlem</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr data-status="paid">
                                        <td><strong>FAT-2026-001</strong></td>
                                        <td>Merkez Plaza</td>
                                        <td>Ocak 2026</td>
                                        <td><strong>₺2,400</strong></td>
                                        <td><span class="badge badge-success">Ödendi</span></td>
                                        <td>05.01.2026</td>
                                        <td>
                                            <button class="btn btn-outline btn-sm" onclick="viewInvoice('FAT-2026-001')"><i class="fas fa-eye"></i></button>
                                            <button class="btn btn-primary btn-sm" onclick="downloadInvoice('FAT-2026-001')"><i class="fas fa-download"></i></button>
                                        </td>
                                    </tr>
                                    <tr data-status="pending">
                                        <td><strong>FAT-2026-002</strong></td>
                                        <td>İş Kulesi</td>
                                        <td>Ocak 2026</td>
                                        <td><strong>₺3,600</strong></td>
                                        <td><span class="badge badge-warning">Bekliyor</span></td>
                                        <td>-</td>
                                        <td>
                                            <button class="btn btn-outline btn-sm" onclick="viewInvoice('FAT-2026-002')"><i class="fas fa-eye"></i></button>
                                            <button class="btn btn-success btn-sm" onclick="markAsPaid('FAT-2026-002')"><i class="fas fa-check"></i></button>
                                        </td>
                                    </tr>
                                    <tr data-status="overdue">
                                        <td><strong>FAT-2025-089</strong></td>
                                        <td>Residence Towers</td>
                                        <td>Aralık 2025</td>
                                        <td><strong>₺4,800</strong></td>
                                        <td><span class="badge badge-danger">Vadesi Geçti</span></td>
                                        <td>-</td>
                                        <td>
                                            <button class="btn btn-outline btn-sm" onclick="viewInvoice('FAT-2025-089')"><i class="fas fa-eye"></i></button>
                                            <button class="btn btn-warning btn-sm" onclick="sendReminder('FAT-2025-089')"><i class="fas fa-bell"></i></button>
                                        </td>
                                    </tr>
                                    <tr data-status="paid">
                                        <td><strong>FAT-2026-003</strong></td>
                                        <td>Ofis Park</td>
                                        <td>Ocak 2026</td>
                                        <td><strong>₺1,800</strong></td>
                                        <td><span class="badge badge-success">Ödendi</span></td>
                                        <td>10.01.2026</td>
                                        <td>
                                            <button class="btn btn-outline btn-sm" onclick="viewInvoice('FAT-2026-003')"><i class="fas fa-eye"></i></button>
                                            <button class="btn btn-primary btn-sm" onclick="downloadInvoice('FAT-2026-003')"><i class="fas fa-download"></i></button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-chart-pie"></i>
                            Gelir Dağılımı
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="chart-container" style="height: 250px;">
                            <canvas id="incomeChart"></canvas>
                        </div>
                        <div style="margin-top: 20px;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 10px; font-size: 14px;">
                                <span><i class="fas fa-circle" style="color: var(--primary); font-size: 10px;"></i> Aylık Bakım</span>
                                <span style="font-weight: 600;">%45</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; margin-bottom: 10px; font-size: 14px;">
                                <span><i class="fas fa-circle" style="color: var(--success); font-size: 10px;"></i> Yıllık Sözleşme</span>
                                <span style="font-weight: 600;">%35</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; font-size: 14px;">
                                <span><i class="fas fa-circle" style="color: var(--warning); font-size: 10px;"></i> Arıza/Onarım</span>
                                <span style="font-weight: 600;">%20</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card" style="margin-top: 25px;">
                <div class="card-header">
                    <div class="card-title">
                        <i class="fas fa-history"></i>
                        Son Finansal Hareketler
                    </div>
                </div>
                <div class="card-body" style="padding: 0;">
                    <div class="activity-item" style="padding: 16px 24px;">
                        <div class="activity-icon" style="background: #d1fae5; color: var(--success);">
                            <i class="fas fa-arrow-down"></i>
                        </div>
                        <div class="activity-content">
                            <div class="activity-title">Ödeme Alındı</div>
                            <div class="activity-desc">Merkez Plaza - Ocak 2026 dönemi</div>
                            <div class="activity-time">Bugün, 14:30 - ₺2,400</div>
                        </div>
                        <span style="color: var(--success); font-weight: 600;">+₺2,400</span>
                    </div>
                    <div class="activity-item" style="padding: 16px 24px;">
                        <div class="activity-icon" style="background: #fee2e2; color: var(--danger);">
                            <i class="fas fa-arrow-up"></i>
                        </div>
                        <div class="activity-content">
                            <div class="activity-title">Fatura Kesildi</div>
                            <div class="activity-desc">İş Kulesi - Şubat 2026 dönemi</div>
                            <div class="activity-time">Dün, 09:15 - ₺3,600</div>
                        </div>
                        <span style="color: var(--danger); font-weight: 600;">-₺3,600</span>
                    </div>
                    <div class="activity-item" style="padding: 16px 24px; border-bottom: none;">
                        <div class="activity-icon" style="background: #dbeafe; color: var(--primary);">
                            <i class="fas fa-file-invoice"></i>
                        </div>
                        <div class="activity-content">
                            <div class="activity-title">Sözleşme Yenilendi</div>
                            <div class="activity-desc">Residence Towers - 2026 yıllık bakım sözleşmesi</div>
                            <div class="activity-time">2 gün önce - ₺57,600</div>
                        </div>
                        <span style="color: var(--success); font-weight: 600;">+₺57,600</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- CALENDAR SECTION -->
        <section id="calendar" class="section-content">
            <div class="page-title">
                <h2><i class="fas fa-calendar-alt"></i> Bakım Takvimi</h2>
                <p>Aylık bakım planlaması ve takibi</p>
            </div>

            <div class="content-grid">
                <div class="card" style="grid-column: 1 / -1;">
                    <div class="card-header">
                        <div class="calendar-header" style="width: 100%; margin: 0;">
                            <div style="display: flex; align-items: center; gap: 15px;">
                                <h3 style="font-size: 20px;">Şubat 2026</h3>
                                <span style="color: var(--gray); font-size: 14px;">Bugün: 8 Şubat 2026</span>
                            </div>
                            <div class="calendar-nav">
                                <button class="btn btn-outline btn-sm" onclick="changeMonth(-1)"><i class="fas fa-chevron-left"></i></button>
                                <button class="btn btn-outline btn-sm" onclick="goToToday()">Bugün</button>
                                <button class="btn btn-outline btn-sm" onclick="changeMonth(1)"><i class="fas fa-chevron-right"></i></button>
                            </div>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="calendar-grid" id="mainCalendar">
                            <!-- Calendar generated by JS -->
                        </div>
                    </div>
                </div>
            </div>

            <div class="content-grid" style="margin-top: 25px;">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-list-ul"></i>
                            Bugünkü Görevler (8 Şubat)
                        </div>
                    </div>
                    <div class="card-body" style="padding: 0;">
                        <div class="activity-item" style="padding: 20px;">
                            <div style="width: 4px; height: 40px; background: var(--danger); border-radius: 2px; margin-right: 5px;"></div>
                            <div class="activity-icon" style="background: #fee2e2; color: var(--danger);">
                                <i class="fas fa-exclamation"></i>
                            </div>
                            <div class="activity-content">
                                <div class="activity-title">Merkez Plaza - Acil Bakım</div>
                                <div class="activity-desc">ASV-001 - Gecikmiş aylık bakım</div>
                                <div class="activity-time">09:00 - 11:00 | Mehmet Kaya</div>
                            </div>
                            <span class="badge badge-danger">Acil</span>
                        </div>
                        <div class="activity-item" style="padding: 20px; border-bottom: none;">
                            <div style="width: 4px; height: 40px; background: var(--warning); border-radius: 2px; margin-right: 5px;"></div>
                            <div class="activity-icon" style="background: #fef3c7; color: var(--warning);">
                                <i class="fas fa-wrench"></i>
                            </div>
                            <div class="activity-content">
                                <div class="activity-title">İş Kulesi - Periyodik Kontrol</div>
                                <div class="activity-desc">ASV-024 - 3 aylık bakım</div>
                                <div class="activity-time">14:00 - 16:00 | Ayşe Demir</div>
                            </div>
                            <span class="badge badge-warning">Planlandı</span>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-chart-bar"></i>
                            Aylık Özet
                        </div>
                    </div>
                    <div class="card-body">
                        <div style="margin-bottom: 20px;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                <span style="font-size: 14px; color: var(--gray);">Toplam Bakım</span>
                                <span style="font-weight: 600;">24</span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 75%;"></div>
                            </div>
                        </div>
                        <div style="margin-bottom: 20px;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                <span style="font-size: 14px; color: var(--gray);">Tamamlanan</span>
                                <span style="font-weight: 600;">18 (%75)</span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 75%; background: var(--success);"></div>
                            </div>
                        </div>
                        <div style="margin-bottom: 20px;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                <span style="font-size: 14px; color: var(--gray);">Bekleyen</span>
                                <span style="font-weight: 600;">4 (%17)</span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 17%; background: var(--warning);"></div>
                            </div>
                        </div>
                        <div>
                            <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                <span style="font-size: 14px; color: var(--gray);">Gecikmiş</span>
                                <span style="font-weight: 600;">2 (%8)</span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 8%; background: var(--danger);"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- MODALS -->

    <!-- Building Modal with Map -->
    <div id="buildingModal" class="modal-overlay">
        <div class="modal-container" style="max-width: 800px;">
            <div class="modal-header">
                <h3 class="modal-title"><i class="fas fa-building"></i> Yeni Bina Ekle</h3>
                <button class="modal-close" onclick="closeModal('buildingModal')"><i class="fas fa-times"></i></button>
            </div>
            <div class="modal-body">
                <form id="buildingForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label>Bina Adı *</label>
                            <input type="text" id="buildingName" required placeholder="Örn: Merkez Plaza">
                        </div>
                        <div class="form-group">
                            <label>Bina Kodu</label>
                            <input type="text" id="buildingCode" placeholder="Otomatik oluşturulacak" disabled>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Adres *</label>
                        <textarea id="buildingAddress" rows="2" required placeholder="Tam adres..."></textarea>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>İlçe *</label>
                            <select id="buildingDistrict" required>
                                <option value="">Seçiniz...</option>
                                <option value="sisli">Şişli</option>
                                <option value="besiktas">Beşiktaş</option>
                                <option value="kadikoy">Kadıköy</option>
                                <option value="uskudar">Üsküdar</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Şehir *</label>
                            <input type="text" id="buildingCity" value="İstanbul" disabled>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Asansör Sayısı *</label>
                            <input type="number" id="elevatorCount" min="1" required value="1">
                        </div>
                        <div class="form-group">
                            <label>Sorumlu Teknisyen</label>
                            <select id="buildingTechnician">
                                <option value="">Seçiniz...</option>
                                <option>Mehmet Kaya</option>
                                <option>Ayşe Demir</option>
                                <option>Ali Yıldız</option>
                            </select>
                        </div>
                    </div>
                    
                    <!-- Map for Location Selection -->
                    <div class="form-group">
                        <label>Konum Seçimi *</label>
                        <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                            <button type="button" class="btn btn-outline btn-sm" onclick="useCurrentLocation()">
                                <i class="fas fa-location-arrow"></i> Mevcut Konumumu Kullan
                            </button>
                            <button type="button" class="btn btn-outline btn-sm" onclick="searchLocation()">
                                <i class="fas fa-search"></i> Adres Ara
                            </button>
                        </div>
                        <div class="map-container" style="height: 300px; margin-bottom: 15px;">
                            <div id="locationMap"></div>
                            <div class="location-selector">
                                <div style="font-weight: 600; margin-bottom: 8px; font-size: 14px;">Konumu Seçin</div>
                                <div style="font-size: 12px; color: var(--gray); margin-bottom: 8px;">
                                    Haritaya tıklayarak konumu belirleyin
                                </div>
                                <div class="location-info">
                                    <div id="selectedLocationInfo">Henüz konum seçilmedi</div>
                                    <div class="location-coordinates">
                                        <input type="text" id="selectedLat" placeholder="Enlem" readonly>
                                        <input type="text" id="selectedLng" placeholder="Boylam" readonly>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>Notlar</label>
                        <textarea id="buildingNotes" rows="2" placeholder="Bina hakkında ek bilgiler..."></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="closeModal('buildingModal')">İptal</button>
                <button class="btn btn-primary" onclick="saveBuildingWithLocation()"><i class="fas fa-save"></i> Kaydet</button>
            </div>
        </div>
    </div>

    <!-- Maintenance Modal -->
    <div id="maintenanceModal" class="modal-overlay">
        <div class="modal-container">
            <div class="modal-header">
                <h3 class="modal-title"><i class="fas fa-tools"></i> Yeni Bakım Planla</h3>
                <button class="modal-close" onclick="closeModal('maintenanceModal')"><i class="fas fa-times"></i></button>
            </div>
            <div class="modal-body">
                <form id="maintenanceForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label>Bina Seçin *</label>
                            <select required id="maintBuilding" onchange="loadElevators()">
                                <option value="">Seçiniz...</option>
                                <option value="BIN-2024-001">Merkez Plaza</option>
                                <option value="BIN-2024-002">İş Kulesi</option>
                                <option value="BIN-2024-003">Residence Towers</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Asansör *</label>
                            <select required id="maintElevator">
                                <option value="">Önce bina seçin...</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Bakım Tarihi *</label>
                            <input type="date" required id="maintDate">
                        </div>
                        <div class="form-group">
                            <label>Saat Aralığı *</label>
                            <select required id="maintTime">
                                <option value="">Seçiniz...</option>
                                <option value="09:00-11:00">09:00 - 11:00</option>
                                <option value="11:00-13:00">11:00 - 13:00</option>
                                <option value="14:00-16:00">14:00 - 16:00</option>
                                <option value="16:00-18:00">16:00 - 18:00</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Bakım Tipi *</label>
                            <select required id="maintType">
                                <option value="">Seçiniz...</option>
                                <option value="monthly">Aylık Bakım</option>
                                <option value="quarterly">3 Aylık Bakım</option>
                                <option value="biannual">6 Aylık Bakım</option>
                                <option value="annual">Yıllık Bakım</option>
                                <option value="repair">Arıza Onarımı</option>
                                <option value="emergency">Acil Müdahale</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Teknisyen *</label>
                            <select required id="maintTechnician">
                                <option value="">Seçiniz...</option>
                                <option value="tek-001">Mehmet Kaya</option>
                                <option value="tek-002">Ayşe Demir</option>
                                <option value="tek-003">Ali Yıldız</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Notlar / Açıklama</label>
                        <textarea rows="3" placeholder="Bakım hakkında ek bilgiler..."></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="closeModal('maintenanceModal')">İptal</button>
                <button class="btn btn-primary" onclick="saveMaintenance()"><i class="fas fa-save"></i> Planla</button>
            </div>
        </div>
    </div>

    <!-- Inspection Modal -->
    <div id="inspectionModal" class="modal-overlay">
        <div class="modal-container">
            <div class="modal-header">
                <h3 class="modal-title"><i class="fas fa-clipboard-check"></i> Yeni Denetim Ekle</h3>
                <button class="modal-close" onclick="closeModal('inspectionModal')"><i class="fas fa-times"></i></button>
            </div>
            <div class="modal-body">
                <form>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Bina *</label>
                            <select required>
                                <option value="">Seçiniz...</option>
                                <option>Merkez Plaza</option>
                                <option>İş Kulesi</option>
                                <option>Residence Towers</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Denetim Tipi *</label>
                            <select required>
                                <option value="">Seçiniz...</option>
                                <option>Yıllık Periyodik Kontrol</option>
                                <option>6 Aylık Kontrol</option>
                                <option>Ara Kontrol</option>
                                <option>Olağanüstü Kontrol</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Denetim Tarihi *</label>
                            <input type="date" required>
                        </div>
                        <div class="form-group">
                            <label>Yetkili Kurum *</label>
                            <select required>
                                <option value="">Seçiniz...</option>
                                <option>İSGM</option>
                                <option>TSE</option>
                                <option>Belediye</option>
                                <option>Özel Firma</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Denetçi Bilgileri</label>
                        <input type="text" placeholder="Denetçi adı ve unvanı...">
                    </div>
                    <div class="form-group">
                        <label>Sonuç ve Notlar</label>
                        <textarea rows="3" placeholder="Denetim sonuçları..."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Dosya Yükle</label>
                        <input type="file" accept=".pdf,.jpg,.png">
                        <small style="color: var(--gray);">PDF, JPG veya PNG formatında yükleyin</small>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="closeModal('inspectionModal')">İptal</button>
                <button class="btn btn-primary" onclick="saveInspection()"><i class="fas fa-save"></i> Kaydet</button>
            </div>
        </div>
    </div>

    <!-- Invoice Modal -->
    <div id="invoiceModal" class="modal-overlay">
        <div class="modal-container">
            <div class="modal-header">
                <h3 class="modal-title"><i class="fas fa-file-invoice-dollar"></i> Yeni Fatura Kes</h3>
                <button class="modal-close" onclick="closeModal('invoiceModal')"><i class="fas fa-times"></i></button>
            </div>
            <div class="modal-body">
                <form>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Bina *</label>
                            <select required>
                                <option value="">Seçiniz...</option>
                                <option>Merkez Plaza</option>
                                <option>İş Kulesi</option>
                                <option>Residence Towers</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Fatura Dönemi *</label>
                            <input type="month" required value="2026-02">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Hizmet Tipi *</label>
                            <select required>
                                <option value="">Seçiniz...</option>
                                <option>Aylık Bakım Ücreti</option>
                                <option>Yıllık Sözleşme</option>
                                <option>Arıza Onarımı</option>
                                <option>Parça Değişimi</option>
                                <option>Diğer</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Tutar (₺) *</label>
                            <input type="number" required placeholder="0.00">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Açıklama</label>
                        <textarea rows="2" placeholder="Fatura açıklaması..."></textarea>
                    </div>
                    <div class="form-group">
                        <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                            <input type="checkbox" checked>
                            <span>Otomatik e-posta gönder</span>
                        </label>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="closeModal('invoiceModal')">İptal</button>
                                <button class="btn btn-primary" onclick="saveInvoice()"><i class="fas fa-save"></i> Fatura Kes</button>
            </div>
        </div>
    </div>

    <!-- Quick Maintenance Modal -->
    <div id="quickMaintenanceModal" class="modal-overlay">
        <div class="modal-container" style="max-width: 400px;">
            <div class="modal-header">
                <h3 class="modal-title"><i class="fas fa-bolt"></i> Hızlı Bakım</h3>
                <button class="modal-close" onclick="closeModal('quickMaintenanceModal')"><i class="fas fa-times"></i></button>
            </div>
            <div class="modal-body">
                <form>
                    <div class="form-group">
                        <label>Asansör Kodu *</label>
                        <input type="text" placeholder="ASV-XXX veya barkod okutun" autofocus>
                    </div>
                    <div class="form-group">
                        <label>Bakım Tipi *</label>
                        <select required>
                            <option value="monthly">Aylık Bakım</option>
                            <option value="repair">Arıza Onarımı</option>
                            <option value="emergency">Acil Müdahale</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Durum *</label>
                        <select required>
                            <option value="completed">Tamamlandı</option>
                            <option value="inprogress">Devam Ediyor</option>
                            <option value="pending">Planlandı</option>
                        </select>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary" onclick="saveQuickMaintenance()" style="width: 100%;">
                    <i class="fas fa-check"></i> Kaydet
                </button>
            </div>
        </div>
    </div>

    <!-- Notification Modal -->
    <div id="notificationModal" class="modal-overlay">
        <div class="modal-container" style="max-width: 450px;">
            <div class="modal-header">
                <h3 class="modal-title"><i class="fas fa-bell"></i> Bildirimler</h3>
                <button class="modal-close" onclick="closeModal('notificationModal')"><i class="fas fa-times"></i></button>
            </div>
            <div class="modal-body" style="padding: 0;">
                <div class="activity-item" style="padding: 16px 24px; background: #fef3c7;">
                    <div class="activity-icon" style="background: var(--warning); color: white;">
                        <i class="fas fa-exclamation"></i>
                    </div>
                    <div class="activity-content">
                        <div class="activity-title">Bakım Gecikmesi</div>
                        <div class="activity-desc">Merkez Plaza ASV-001 bakımı 2 gün gecikti</div>
                        <div class="activity-time">10 dakika önce</div>
                    </div>
                </div>
                <div class="activity-item" style="padding: 16px 24px;">
                    <div class="activity-icon" style="background: #dbeafe; color: var(--primary);">
                        <i class="fas fa-file-alt"></i>
                    </div>
                    <div class="activity-content">
                        <div class="activity-title">Yeni Rapor Yüklendi</div>
                        <div class="activity-desc">İş Kulesi denetim raporu sisteme eklendi</div>
                        <div class="activity-time">1 saat önce</div>
                    </div>
                </div>
                <div class="activity-item" style="padding: 16px 24px;">
                    <div class="activity-icon" style="background: #d1fae5; color: var(--success);">
                        <i class="fas fa-lira-sign"></i>
                    </div>
                    <div class="activity-content">
                        <div class="activity-title">Ödeme Alındı</div>
                        <div class="activity-desc">Residence Towers'dan ₺4,800 ödeme alındı</div>
                        <div class="activity-time">3 saat önce</div>
                    </div>
                </div>
                <div class="activity-item" style="padding: 16px 24px; border-bottom: none;">
                    <div class="activity-icon" style="background: #fee2e2; color: var(--danger);">
                        <i class="fas fa-calendar-times"></i>
                    </div>
                    <div class="activity-content">
                        <div class="activity-title">Denetim Yaklaşıyor</div>
                        <div class="activity-desc">Merkez Plaza yıllık kontrolü 7 gün sonra</div>
                        <div class="activity-time">Dün</div>
                    </div>
                </div>
            </div>
            <div class="modal-footer" style="justify-content: center;">
                <button class="btn btn-outline btn-sm" onclick="markAllRead()">
                    <i class="fas fa-check-double"></i> Tümünü Okundu İşaretle
                </button>
            </div>
        </div>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.js"></script>
    <script>
        // Global Variables
        let map;
        let locationMap;
        let marker;
        let incomeChart;
        let currentMonth = new Date().getMonth();
        let currentYear = new Date().getFullYear();
        let selectedLocation = null;

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            initMap();
            initCharts();
            generateCalendar();
            
            // Set today's date in maintenance modal
            document.getElementById('maintDate').valueAsDate = new Date();
            
            // Generate building code
            generateBuildingCode();
        });

        // Navigation
        function showSection(sectionId, element) {
            // Hide all sections
            document.querySelectorAll('.section-content').forEach(section => {
                section.classList.remove('active');
            });
            
            // Show selected section
            document.getElementById(sectionId).classList.add('active');
            
            // Update nav active state
            document.querySelectorAll('.main-nav .nav-item a').forEach(link => {
                link.classList.remove('active');
            });
            element.classList.add('active');
            
            // Update breadcrumb
            const titles = {
                'map': 'Harita',
                'buildings': 'Bina Yönetimi',
                'maintenance': 'Bakım Yönetimi',
                'inspections': 'Denetim Yönetimi',
                'forms': 'Form Oluşturucu',
                'accounting': 'Muhasebe & Finans',
                'calendar': 'Bakım Takvimi'
            };
            document.getElementById('breadcrumbText').textContent = titles[sectionId];
            
            // Refresh map if needed
            if (sectionId === 'map' && map) {
                setTimeout(() => {
                    map.invalidateSize();
                }, 100);
            }
            
            // Refresh charts if accounting section
            if (sectionId === 'accounting' && incomeChart) {
                incomeChart.resize();
            }
        }

        // Modal Functions
        function openModal(modalId) {
            document.getElementById(modalId).classList.add('active');
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }

        function openBuildingModal() {
            openModal('buildingModal');
            // Initialize location map
            setTimeout(initLocationMap, 100);
        }

        // Map Functions
        function initMap() {
            if (window.mapInitialized) return;
            
            map = L.map('map').setView([41.0082, 28.9784], 12);
            
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '© OpenStreetMap contributors'
            }).addTo(map);

            const buildings = [
                {lat: 41.0082, lng: 28.9784, name: 'Merkez Plaza', status: 'danger', address: 'Şişli, İstanbul'},
                {lat: 41.0214, lng: 28.9732, name: 'İş Kulesi', status: 'warning', address: 'Levent, İstanbul'},
                {lat: 41.0350, lng: 28.9850, name: 'Residence Towers', status: 'ok', address: 'Beşiktaş, İstanbul'},
                {lat: 41.0120, lng: 28.9600, name: 'Ofis Park', status: 'ok', address: 'Fatih, İstanbul'},
                {lat: 41.0250, lng: 29.0100, name: 'Plaza 34', status: 'pending', address: 'Üsküdar, İstanbul'}
            ];

            const colors = {
                ok: '#059669',
                warning: '#d97706',
                danger: '#dc2626',
                pending: '#1e40af'
            };

            const statusText = {
                ok: 'Bakım Tamamlandı',
                warning: 'Bakım Yaklaşıyor',
                danger: 'Acil Bakım Gerekli',
                pending: 'Planlandı'
            };

            buildings.forEach(b => {
                const marker = L.circleMarker([b.lat, b.lng], {
                    radius: 14,
                    fillColor: colors[b.status],
                    color: '#fff',
                    weight: 3,
                    opacity: 1,
                    fillOpacity: 0.9
                }).addTo(map);
                
                marker.bindPopup(`
                    <div style="min-width: 200px;">
                        <h4 style="margin: 0 0 8px 0; color: var(--dark);">${b.name}</h4>
                        <p style="margin: 0 0 8px 0; color: #666; font-size: 13px;">${b.address}</p>
                        <div style="display: flex; align-items: center; gap: 6px; margin-bottom: 10px;">
                            <span style="width: 8px; height: 8px; border-radius: 50%; background: ${colors[b.status]};"></span>
                            <span style="font-size: 12px; color: ${colors[b.status]}; font-weight: 600;">${statusText[b.status]}</span>
                        </div>
                        <button onclick="viewBuildingFromMap('${b.name}')" style="background: var(--primary); color: white; border: none; padding: 6px 12px; border-radius: 6px; cursor: pointer; font-size: 12px; width: 100%;">
                            Detayları Gör
                        </button>
                    </div>
                `);
            });

            window.mapInitialized = true;
        }

        // Location Map for Building Modal
        function initLocationMap() {
            if (document.getElementById('locationMap')) {
                locationMap = L.map('locationMap').setView([41.0082, 28.9784], 12);
                
                L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                    attribution: '© OpenStreetMap contributors'
                }).addTo(locationMap);
                
                // Add click event to map
                locationMap.on('click', function(e) {
                    setLocationMarker(e.latlng.lat, e.latlng.lng);
                    selectedLocation = e.latlng;
                    updateLocationInfo(e.latlng.lat, e.latlng.lng);
                });
                
                // Initialize geocoder
                L.Control.geocoder({
                    defaultMarkGeocode: false
                }).on('markgeocode', function(e) {
                    const latlng = e.geocode.center;
                    locationMap.setView(latlng, 16);
                    setLocationMarker(latlng.lat, latlng.lng);
                    selectedLocation = latlng;
                    updateLocationInfo(latlng.lat, latlng.lng);
                }).addTo(locationMap);
            }
        }

        function setLocationMarker(lat, lng) {
            if (marker) {
                locationMap.removeLayer(marker);
            }
            
            marker = L.marker([lat, lng], {
                draggable: true
            }).addTo(locationMap);
            
            marker.on('dragend', function(e) {
                const position = marker.getLatLng();
                selectedLocation = position;
                updateLocationInfo(position.lat, position.lng);
            });
        }

        function updateLocationInfo(lat, lng) {
            document.getElementById('selectedLocationInfo').innerHTML = `
                <div><strong>Enlem:</strong> ${lat.toFixed(6)}</div>
                <div><strong>Boylam:</strong> ${lng.toFixed(6)}</div>
            `;
            document.getElementById('selectedLat').value = lat.toFixed(6);
            document.getElementById('selectedLng').value = lng.toFixed(6);
        }

        function useCurrentLocation() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(function(position) {
                    const lat = position.coords.latitude;
                    const lng = position.coords.longitude;
                    
                    locationMap.setView([lat, lng], 16);
                    setLocationMarker(lat, lng);
                    selectedLocation = L.latLng(lat, lng);
                    updateLocationInfo(lat, lng);
                }, function(error) {
                    alert('Konum alınamadı: ' + error.message);
                });
            } else {
                alert('Tarayıcınız konum özelliğini desteklemiyor.');
            }
        }

        function searchLocation() {
            const address = document.getElementById('buildingAddress').value;
            if (!address.trim()) {
                alert('Lütfen önce bir adres girin.');
                return;
            }
            
            // Using Nominatim OpenStreetMap geocoder
            fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(address)}&limit=1`)
                .then(response => response.json())
                .then(data => {
                    if (data.length > 0) {
                        const lat = parseFloat(data[0].lat);
                        const lng = parseFloat(data[0].lon);
                        
                        locationMap.setView([lat, lng], 16);
                        setLocationMarker(lat, lng);
                        selectedLocation = L.latLng(lat, lng);
                        updateLocationInfo(lat, lng);
                    } else {
                        alert('Adres bulunamadı.');
                    }
                })
                .catch(error => {
                    console.error('Geocoding error:', error);
                    alert('Adres aranırken hata oluştu.');
                });
        }

        function saveBuildingWithLocation() {
            const form = document.getElementById('buildingForm');
            
            if (!form.checkValidity()) {
                form.reportValidity();
                return;
            }
            
            if (!selectedLocation) {
                alert('Lütfen haritadan bir konum seçin.');
                return;
            }
            
            const buildingData = {
                name: document.getElementById('buildingName').value,
                code: document.getElementById('buildingCode').value,
                address: document.getElementById('buildingAddress').value,
                district: document.getElementById('buildingDistrict').value,
                elevators: document.getElementById('elevatorCount').value,
                technician: document.getElementById('buildingTechnician').value,
                location: {
                    lat: selectedLocation.lat,
                    lng: selectedLocation.lng
                },
                notes: document.getElementById('buildingNotes').value
            };
            
            console.log('Building saved:', buildingData);
            alert(`Bina başarıyla eklendi!\nKonum: ${selectedLocation.lat.toFixed(6)}, ${selectedLocation.lng.toFixed(6)}`);
            closeModal('buildingModal');
            resetBuildingForm();
            
            // Add to main map
            addBuildingToMap(buildingData);
        }

        function addBuildingToMap(buildingData) {
            if (!map) return;
            
            const newMarker = L.circleMarker([buildingData.location.lat, buildingData.location.lng], {
                radius: 14,
                fillColor: '#1e40af',
                color: '#fff',
                weight: 3,
                opacity: 1,
                fillOpacity: 0.9
            }).addTo(map);
            
            newMarker.bindPopup(`
                <div style="min-width: 200px;">
                    <h4 style="margin: 0 0 8px 0; color: var(--dark);">${buildingData.name}</h4>
                    <p style="margin: 0 0 8px 0; color: #666; font-size: 13px;">${buildingData.address}</p>
                    <div style="display: flex; align-items: center; gap: 6px; margin-bottom: 10px;">
                        <span style="width: 8px; height: 8px; border-radius: 50%; background: #1e40af;"></span>
                        <span style="font-size: 12px; color: #1e40af; font-weight: 600;">Yeni Eklendi</span>
                    </div>
                </div>
            `);
        }

        function resetBuildingForm() {
            document.getElementById('buildingForm').reset();
            selectedLocation = null;
            document.getElementById('selectedLocationInfo').textContent = 'Henüz konum seçilmedi';
            document.getElementById('selectedLat').value = '';
            document.getElementById('selectedLng').value = '';
            generateBuildingCode();
            
            if (marker) {
                locationMap.removeLayer(marker);
                marker = null;
            }
        }

        function generateBuildingCode() {
            const now = new Date();
            const code = `BIN-${now.getFullYear()}-${String(now.getMonth() + 1).padStart(2, '0')}-${Math.floor(Math.random() * 1000).toString().padStart(3, '0')}`;
            document.getElementById('buildingCode').value = code;
        }

        function resetMap() {
            if (map) {
                map.setView([41.0082, 28.9784], 12);
            }
        }

        function locateMe() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(function(position) {
                    map.setView([position.coords.latitude, position.coords.longitude], 15);
                }, function(error) {
                    alert('Konum alınamadı: ' + error.message);
                });
            } else {
                alert('Tarayıcınız konum özelliğini desteklemiyor.');
            }
        }

        // Chart Functions
        function initCharts() {
            // Income Chart
            const incomeCtx = document.getElementById('incomeChart').getContext('2d');
            incomeChart = new Chart(incomeCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Aylık Bakım', 'Yıllık Sözleşme', 'Arıza/Onarım'],
                    datasets: [{
                        data: [45, 35, 20],
                        backgroundColor: ['#1e40af', '#059669', '#d97706'],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    cutout: '70%',
                    plugins: {
                        legend: {
                            display: false
                        }
                    }
                }
            });
        }

        // Calendar Functions
        function generateCalendar() {
            const grid = document.getElementById('mainCalendar');
            if (!grid) return;
            
            grid.innerHTML = '';
            const days = ['Pzt', 'Sal', 'Çar', 'Per', 'Cum', 'Cmt', 'Paz'];
            
            // Headers
            days.forEach(day => {
                const header = document.createElement('div');
                header.className = 'calendar-day-header';
                header.textContent = day;
                grid.appendChild(header);
            });

            // February 2026 (starts on Sunday, but we start from Monday)
            // Add empty cells for previous month
            for (let i = 0; i < 6; i++) {
                const empty = document.createElement('div');
                empty.style.background = '#f1f5f9';
                empty.style.borderRadius = '10px';
                grid.appendChild(empty);
            }

            // Days
            const events = {
                8: 'maintenance',
                12: 'warning',
                15: 'inspection',
                20: 'maintenance',
                25: 'warning'
            };

            for (let i = 1; i <= 28; i++) {
                const day = document.createElement('div');
                day.className = 'calendar-day';
                
                if (i === 8) {
                    day.classList.add('active');
                }
                
                if (events[i]) {
                    day.classList.add('has-event');
                    day.style.borderColor = events[i] === 'maintenance' ? 'var(--primary)' : 
                                           events[i] === 'warning' ? 'var(--warning)' : 'var(--success)';
                    day.style.background = events[i] === 'maintenance' ? '#eff6ff' : 
                                          events[i] === 'warning' ? '#fffbeb' : '#f0fdf4';
                }

                day.innerHTML = `
                    <span class="day-number">${i}</span>
                `;
                
                day.onclick = () => showDayDetail(i);
                grid.appendChild(day);
            }
        }

        function changeMonth(direction) {
            // Simplified month change
            alert(direction > 0 ? 'Sonraki ay' : 'Önceki ay');
        }

        function goToToday() {
            alert('Bugün: 8 Şubat 2026');
        }

        function showDayDetail(day) {
            alert(`${day} Şubat 2026 - Detaylı bakım listesi gösterilecek`);
        }

        // Form Builder Functions
        function allowDrop(ev) {
            ev.preventDefault();
        }

        function drag(ev) {
            ev.dataTransfer.setData("type", ev.target.getAttribute('data-type'));
        }

        function drop(ev) {
            ev.preventDefault();
            const type = ev.dataTransfer.getData("type");
            addFormField(type);
        }

        function addFormField(type) {
            const canvas = document.getElementById('formCanvas');
            const placeholder = document.getElementById('formPlaceholder');
            
            if (placeholder) {
                placeholder.remove();
            }

            const fieldId = 'field_' + Date.now();
            const fieldDiv = document.createElement('div');
            fieldDiv.className = 'form-element';
            fieldDiv.id = fieldId;

            const labels = {
                text: 'Metin Alanı',
                number: 'Sayı Alanı',
                date: 'Tarih Alanı',
                select: 'Seçim Listesi',
                textarea: 'Uzun Metin Alanı',
                checkbox: 'Onay Kutusu',
                radio: 'Seçenek Grubu',
                file: 'Fotoğraf Yükleme',
                signature: 'İmza Alanı'
            };

            let inputHTML = '';
            switch(type) {
                case 'text':
                    inputHTML = '<input type="text" placeholder="Metin giriniz..." style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px;">';
                    break;
                case 'number':
                    inputHTML = '<input type="number" placeholder="0" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px;">';
                    break;
                case 'date':
                    inputHTML = '<input type="date" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px;">';
                    break;
                case 'select':
                    inputHTML = `<select style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px;">
                        <option>Seçenek 1</option>
                        <option>Seçenek 2</option>
                        <option>Seçenek 3</option>
                    </select>`;
                    break;
                case 'textarea':
                    inputHTML = '<textarea rows="3" placeholder="Uzun metin giriniz..." style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px;"></textarea>';
                    break;
                case 'checkbox':
                    inputHTML = '<label style="display: flex; align-items: center; gap: 8px;"><input type="checkbox"> Onaylıyorum</label>';
                    break;
                case 'radio':
                    inputHTML = `<div style="display: flex; flex-direction: column; gap: 8px;">
                        <label style="display: flex; align-items: center; gap: 8px;"><input type="radio" name="${fieldId}"> Seçenek 1</label>
                        <label style="display: flex; align-items: center; gap: 8px;"><input type="radio" name="${fieldId}"> Seçenek 2</label>
                    </div>`;
                    break;
                case 'file':
                    inputHTML = '<input type="file" accept="image/*" style="width: 100%; padding: 10px;">';
                    break;
                case 'signature':
                    inputHTML = '<div style="border: 2px dashed #ddd; border-radius: 6px; padding: 40px; text-align: center; color: #999;">İmza alanı için tıklayın</div>';
                    break;
            }

            fieldDiv.innerHTML = `
                <div class="element-actions">
                    <button class="action-btn btn-primary" onclick="editField('${fieldId}')" title="Düzenle"><i class="fas fa-edit"></i></button>
                    <button class="action-btn btn-danger" onclick="removeField('${fieldId}')" title="Sil"><i class="fas fa-trash"></i></button>
                </div>
                <label style="display: block; margin-bottom: 8px; font-weight: 500;">${labels[type]}</label>
                ${inputHTML}
            `;

            canvas.appendChild(fieldDiv);
        }

        function removeField(fieldId) {
            document.getElementById(fieldId).remove();
            const canvas = document.getElementById('formCanvas');
            if (canvas.children.length === 0) {
                canvas.innerHTML = `
                    <div class="empty-state" id="formPlaceholder">
                        <i class="fas fa-mouse-pointer"></i>
                        <h3>Form Oluşturmaya Başlayın</h3>
                        <p>Sol taraftan form elemanlarını sürükleyip buraya bırakın<br>veya hazır şablonlardan birini seçin</p>
                    </div>
                `;
            }
        }

        function editField(fieldId) {
            const newLabel = prompt('Yeni başlık:', document.querySelector(`#${fieldId} label`).textContent);
            if (newLabel) {
                document.querySelector(`#${fieldId} label`).textContent = newLabel;
            }
        }

        function loadTemplate(type) {
            const canvas = document.getElementById('formCanvas');
            canvas.innerHTML = '';
            
            const templates = {
                maintenance: ['text', 'date', 'select', 'textarea', 'file', 'signature'],
                inspection: ['text', 'date', 'select', 'checkbox', 'textarea', 'signature'],
                failure: ['text', 'date', 'textarea', 'file', 'select', 'signature']
            };
            
            templates[type].forEach(fieldType => addFormField(fieldType));
        }

        function clearForm() {
            if (confirm('Formu temizlemek istediğinize emin misiniz?')) {
                document.getElementById('formCanvas').innerHTML = `
                    <div class="empty-state" id="formPlaceholder">
                        <i class="fas fa-mouse-pointer"></i>
                        <h3>Form Oluşturmaya Başlayın</h3>
                        <p>Sol taraftan form elemanlarını sürükleyip buraya bırakın<br>veya hazır şablonlardan birini seçin</p>
                    </div>
                `;
            }
        }

        function saveForm() {
            alert('Form başarıyla kaydedildi!');
        }

        function previewForm() {
            alert('Form önizlemesi yeni sekmede açılacak');
        }

        // Filter Functions
        function filterBuildings() {
            const searchTerm = document.getElementById('buildingSearch').value.toLowerCase();
            const district = document.getElementById('districtFilter').value;
            const status = document.getElementById('statusFilter').value;
            
            const rows = document.querySelectorAll('#buildingsTable tbody tr');
            
            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                const rowDistrict = row.getAttribute('data-district');
                const rowStatus = row.getAttribute('data-status');
                
                const matchesSearch = text.includes(searchTerm);
                const matchesDistrict = !district || rowDistrict === district;
                const matchesStatus = !status || rowStatus === status;
                
                row.style.display = matchesSearch && matchesDistrict && matchesStatus ? '' : 'none';
            });
        }

        function filterInvoices() {
            const searchTerm = document.getElementById('invoiceSearch').value.toLowerCase();
            const status = document.getElementById('invoiceStatusFilter').value;
            
            const rows = document.querySelectorAll('#invoicesTable tbody tr');
            
            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                const rowStatus = row.getAttribute('data-status');
                
                const matchesSearch = text.includes(searchTerm);
                const matchesStatus = !status || rowStatus === status;
                
                row.style.display = matchesSearch && matchesStatus ? '' : 'none';
            });
        }

        // Action Functions
        function makeEmergencyCall() {
            if (confirm('Acil destek hattını aramak istiyor musunuz?\n\n0850 123 45 67')) {
                window.location.href = 'tel:08501234567';
            }
        }

        function showNotifications() {
            openModal('notificationModal');
            // Reset badge
            document.getElementById('notifCount').textContent = '0';
        }

        function markAllRead() {
            document.getElementById('notifCount').textContent = '0';
            closeModal('notificationModal');
        }

        function toggleUserMenu() {
            alert('Kullanıcı menüsü: Profil, Ayarlar, Çıkış');
        }

        function navigateToBuilding(buildingName) {
            alert(`${buildingName} için navigasyon başlatılıyor...`);
        }

        function startNavigation() {
            alert('Rota başlatıldı! Navigasyon uygulaması açılacak.');
        }

        // Save Functions
        function saveMaintenance() {
            const form = document.getElementById('maintenanceForm');
            if (form.checkValidity()) {
                alert('Bakım başarıyla planlandı!');
                closeModal('maintenanceModal');
                form.reset();
            } else {
                form.reportValidity();
            }
        }

        function saveInspection() {
            alert('Denetim başarıyla kaydedildi!');
            closeModal('inspectionModal');
        }

        function saveInvoice() {
            alert('Fatura başarıyla kesildi!');
            closeModal('invoiceModal');
        }

        function saveQuickMaintenance() {
            alert('Hızlı bakım kaydı oluşturuldu!');
            closeModal('quickMaintenanceModal');
        }

        // Helper Functions
        function loadElevators() {
            const building = document.getElementById('maintBuilding').value;
            const elevatorSelect = document.getElementById('maintElevator');
            
            const elevators = {
                'BIN-2024-001': ['ASV-001 (A Blok)', 'ASV-002 (B Blok)', 'ASV-003 (C Blok)', 'ASV-004 (D Blok)'],
                'BIN-2024-002': ['ASV-021', 'ASV-022', 'ASV-023', 'ASV-024', 'ASV-025', 'ASV-026'],
                'BIN-2024-003': ['ASV-081', 'ASV-082', 'ASV-083', 'ASV-084', 'ASV-085', 'ASV-086', 'ASV-087', 'ASV-088']
            };
            
            elevatorSelect.innerHTML = '<option value="">Seçiniz...</option>';
            
            if (elevators[building]) {
                elevators[building].forEach(elevator => {
                    const option = document.createElement('option');
                    option.value = elevator.split(' ')[0];
                    option.textContent = elevator;
                    elevatorSelect.appendChild(option);
                });
            }
        }

        function exportToExcel(tableId) {
            const table = document.getElementById(tableId);
            const wb = XLSX.utils.table_to_book(table, {sheet: "Sheet1"});
            XLSX.writeFile(wb, `Rapor_${new Date().toISOString().split('T')[0]}.xlsx`);
        }

        function exportTable(tableId) {
            exportToExcel(tableId);
        }

        // View Functions
        function viewBuildingFromMap(buildingName) {
            alert(`${buildingName} detayları gösteriliyor...`);
        }

        function openMaintenanceDetail(elevatorId) {
            alert(`Asansör ${elevatorId} için bakım detayları ve planlama ekranı`);
        }

        function viewReport(reportId) {
            alert(`Rapor ${reportId} görüntüleniyor...`);
        }

        function viewBuilding(buildingId) {
            alert(`Bina ${buildingId} detayları gösteriliyor...`);
        }

        function editBuilding(buildingId) {
            alert(`Bina ${buildingId} düzenleme modu`);
        }

        function deleteBuilding(buildingId) {
            if (confirm(`Bina ${buildingId} silinecek. Emin misiniz?`)) {
                alert('Bina silindi');
            }
        }

        function viewInvoice(invoiceId) {
            alert(`Fatura ${invoiceId} görüntüleniyor...`);
        }

        function downloadInvoice(invoiceId) {
            alert(`Fatura ${invoiceId} indiriliyor...`);
        }

        function markAsPaid(invoiceId) {
            if (confirm(`Fatura ${invoiceId} ödendi olarak işaretlenecek. Emin misiniz?`)) {
                alert('Fatura ödendi olarak işaretlendi');
            }
        }

        function sendReminder(invoiceId) {
            alert(`Fatura ${invoiceId} için hatırlatma e-postası gönderildi`);
        }

        function downloadDoc(docId) {
            alert(`Belge ${docId} indiriliyor...`);
        }

        // Close modals on outside click
        window.onclick = function(event) {
            if (event.target.classList.contains('modal-overlay')) {
                event.target.classList.remove('active');
            }
        }
    </script>
</body>
</html>
